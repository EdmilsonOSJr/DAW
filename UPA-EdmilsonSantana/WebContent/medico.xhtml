<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="/_template.xhtml">


	<ui:define name="corpo">

		<h:outputScript name="jsf.js" library="javax.faces" target="head"></h:outputScript>
		<h:form id="cadastro">
			<p:messages styleClass="erros"></p:messages>
			<h2>
				<h:outputText value="Novo Médico"
					rendered="#{empty medicoBean.medico.crm}" />
				<h:outputText value="Editar Médico"
					rendered="#{not empty medicoBean.medico.crm}" />
			</h2>

			<p:fieldset legend="Dados do Médico">

				<h:outputLabel value="CRM" for="crm" />
				<p:inputText id="crm" value="#{medicoBean.medico.crm}" />

				<h:outputLabel value="Nome:" for="nome" />
				<p:inputText id="nome" value="#{medicoBean.medico.nome}" />

				<h:outputLabel value="Telefone:" for="tel" />
				<p:inputMask id="tel" value="#{pacienteBean.paciente.telefone}"
					mask="(99) 9999-9999" validateMask="true" />

				<h:outputLabel value="Especialidade:" for="area" />
				<p:inputTextarea id="area" value="#{medicoBean.medico.area}" />

				<h:outputLabel value="Salário:" for="salario" />
				<p:inputText id="salario" value="#{medicoBean.medico.salario}" required="true" requiredMessage="Salário obrigatório."
					validatorMessage="O valor mínimo é de R$5.000,00">
					<f:validateDoubleRange minimum="5000" />
				</p:inputText>
				
				<h:commandButton value="Gravar" action="#{medicoBean.grava}">
					<f:ajax execute="@form" render=":cadastro :lista"></f:ajax>
				</h:commandButton>

				<h:commandButton value="Cancelar" action="#{medicoBean.cancela}" />

			</p:fieldset>

		</h:form>

		<h2>Listagem de Médicos</h2>

		<h:form id="lista">
		
			<p:dataTable value="#{medicoBean.medicos}" var="medico" paginator="true" rows="4">
				<p:column headerText="Nome">
				
					#{medico.nome}

				</p:column>
				
				<p:column headerText="CRM">
				
					#{medico.crm}

				</p:column>

				<p:column headerText="Telefone">
					#{medico.telefone}
				</p:column>

				<p:column headerText="Especialidade">
					#{medico.area}
				</p:column>

				<p:column headerText="Salário">
					#{medico.salario}
					#{medicoBean.salarioTotal}
				</p:column>
					
				<p:column headerText="Ações">

					<h:commandLink value="Alterar" styleClass="btn">
						<f:setPropertyActionListener value="#{medico}"
							target="#{medicoBean.medico}" />

						<f:ajax render=":cadastro"></f:ajax>
					</h:commandLink>

					<h:commandLink action="#{medicoBean.remove(medico)}"
						value="Remover" styleClass="btn btn-danger">
						<f:ajax render="@form"></f:ajax>
					</h:commandLink>


				</p:column>
				
			</p:dataTable>
			
		</h:form>

	</ui:define>

</ui:composition>

</html>